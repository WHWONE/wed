<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SoundFont Virtual Keyboard ‚Äì Scales, Modes & Patterns</title>
<style>
  body {
    background: radial-gradient(circle at center, #111, #000);
    color: #eaeaea;
    font-family: "Segoe UI", sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    padding-top: 40px;
  }
  h1 { font-weight: 300; margin-bottom: 10px; }

  select, button {
    margin: 6px;
    padding: 10px 16px;
    border-radius: 8px;
    border: none;
    font-size: 1rem;
  }
  select { background:#2c2c2c; color:#eaeaea; }
  button {
    background:#4caf50;
    color:white;
    cursor:pointer;
    transition:0.2s;
  }
  button:hover { background:#43a047; }

  #keyboard {
    position: relative;
    display: flex;
    justify-content: center;
    user-select: none;
  }
  .white-keys {
    display:flex;
    position:relative;
    z-index:1;
  }
  .black-keys {
    position:absolute;
    top:0;
    left:0;
    height:150px;
    z-index:2;
  }
  .white {
    width:60px;
    height:240px;
    background:white;
    border:1px solid #000;
    border-radius:0 0 4px 4px;
    box-sizing:border-box;
    cursor:pointer;
  }
  .black {
    width:36px;
    height:150px;
    background:black;
    border:1px solid #222;
    border-radius:0 0 4px 4px;
    position:absolute;
    cursor:pointer;
  }
  .white.active {
    background:#8ef;
    box-shadow:0 0 20px #00bfff;
  }
  .black.active {
    background:#00bfff;
    box-shadow:0 0 20px #00bfff;
  }
  #status {
    margin-top:16px;
    opacity:0.8;
  }

  /* ===== Control Panel Three-Column Layout ===== */
  #controlPanel {
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: flex-start;
    gap: 20px;
    flex-wrap: nowrap;
    margin-top: 20px;
    width: 90%;
    max-width: 1200px;
  }

  #durationMixer,
  #tempoDynamics,
  #melodyPanel {
    flex: 1 1 30%;
    min-width: 250px;
  }

  #intervalMixer, #tempoDynamics {
    flex: 1 1 45%;
    display:grid;
    grid-template-columns:180px 200px 60px;
    row-gap:8px;
    column-gap:8px;
    align-items:center;
    font-size:0.95rem;
  }
  input[type=range] {
    width:200px;
    cursor:pointer;
  }

#melodyPanel {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  background: #222;
  padding: 10px;
  border-radius: 10px;
  box-shadow: 0 0 6px rgba(255,255,255,0.1);
  color: white;
  margin-top: 15px;
}

#melodyPanel h3 {
  margin-bottom: 8px;
  font-size: 1.1em;
  color: #ffe680;
  text-align: center;
}

.number-row {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 10px 15px;
}

.num-wrap {
  display: flex;
  flex-direction: column;
  align-items: center;
  font-size: 0.8em;
  width: 85px;
}

.num-wrap input[type=number] {
  width: 60px;
  background: #333;
  color: #fff;
  border: 1px solid #555;
  border-radius: 5px;
  text-align: center;
  margin-top: 4px;
  padding: 3px;
}


  /* Pattern Controls */
  #patternControls {
    margin-top:18px;
    display:flex;
    gap:8px;
    align-items:center;
    font-size:0.95rem;
    flex-wrap: wrap;
    justify-content: center;
  }
  #patternBank {
    display:inline-flex;
    gap:6px;
    margin-right:8px;
  }
  .patternSlot {
    background:#555;
    border:none;
    color:white;
    padding:6px 10px;
    border-radius:6px;
    cursor:pointer;
    font-size:0.9rem;
  }
  .patternSlot.active {
    background:#00bfff;
    box-shadow:0 0 8px #00bfff;
  }
  #patternInfo {
    opacity:0.75;
    margin-left:4px;
  }

  /* Duration Mixer */
  #durationMixer {
    margin-top: 20px;
    display:grid;
    grid-template-columns:180px 200px 60px;
    row-gap:8px;
    column-gap:8px;
    align-items:center;
    font-size:0.95rem;
  }

  @media (max-width: 800px) {
    #controlPanel {
      flex-direction: column;
      align-items: center;
    }
  }
</style>
</head>
<body>
  <h1>üéπ SoundFont Virtual Keyboard ‚Äì Scales, Modes & Patterns</h1>

  <div>
    <label for="keySelect">Key:</label>
    <select id="keySelect">
      <option value="C">C</option><option value="C#">C‚ôØ / D‚ô≠</option>
      <option value="D">D</option><option value="D#">D‚ôØ / E‚ô≠</option>
      <option value="E">E</option><option value="F">F</option>
      <option value="F#">F‚ôØ / G‚ô≠</option><option value="G">G</option>
      <option value="G#">G‚ôØ / A‚ô≠</option><option value="A">A</option>
      <option value="A#">A‚ôØ / B‚ô≠</option><option value="B">B</option>
    </select>

    <label for="modeSelect">Mode:</label>
    <select id="modeSelect">
      <option value="ionian">Ionian (Major)</option>
      <option value="dorian">Dorian</option>
      <option value="phrygian">Phrygian</option>
      <option value="lydian">Lydian</option>
      <option value="mixolydian">Mixolydian</option>
      <option value="aeolian">Aeolian (Minor)</option>
      <option value="locrian">Locrian</option>
      <option value="pent_major">Pentatonic Major</option>
      <option value="pent_minor">Pentatonic Minor</option>
      <option value="chromatic">Chromatic (All Notes)</option>
    </select>

    <!-- üéµ Note Range Controls -->
    <div id="noteRangeControls" style="margin-top:10px;">
      <label for="lowNoteSelect">Low Note:</label>
      <select id="lowNoteSelect"></select>
      <label for="highNoteSelect">High Note:</label>
      <select id="highNoteSelect"></select>
    </div>

    <button id="playRandom">Play One Note</button>
    <button id="playChord">Play One Chord</button>
    <button id="playChordLoop">‚ñ∂Ô∏è Chord Loop</button>
    <button id="startLoop">‚ñ∂Ô∏è Note Loop</button>
    <button id="stopLoop" disabled>‚èπ Stop</button>
  </div>

  <div id="keyboard">
    <div class="white-keys" id="whiteKeys"></div>
    <div class="black-keys" id="blackKeys"></div>
  </div>

  <p id="status">Loading SoundFont‚Ä¶</p>

  <!-- Two-column Control Panel -->
  <div id="controlPanel">

    <!-- üéµ Duration Probability (Left Column) -->
<div id="durationMixer">
  <label>üéµ Whole Notes</label><input type="range" id="durWhole" min="0" max="100" value="10"><span id="valWhole">10%</span>

  <label>Half Notes</label><input type="range" id="durHalf" min="0" max="100" value="15"><span id="valHalf">15%</span>
  <label>Dotted Half</label><input type="range" id="durDottedHalf" min="0" max="100" value="5"><span id="valDottedHalf">5%</span>

  <label>Quarter Notes</label><input type="range" id="durQuarter" min="0" max="100" value="40"><span id="valQuarter">40%</span>
  <label>Dotted Quarter</label><input type="range" id="durDottedQuarter" min="0" max="100" value="5"><span id="valDottedQuarter">5%</span>
  <label>Quarter Triplet</label><input type="range" id="durQuarterTriplet" min="0" max="100" value="5"><span id="valQuarterTriplet">5%</span>

  <label>Eighth Notes</label><input type="range" id="durEighth" min="0" max="100" value="20"><span id="valEighth">20%</span>
  <label>Dotted Eighth</label><input type="range" id="durDottedEighth" min="0" max="100" value="5"><span id="valDottedEighth">5%</span>
  <label>Eighth Triplet</label><input type="range" id="durEighthTriplet" min="0" max="100" value="5"><span id="valEighthTriplet">5%</span>

  <label>Sixteenth Notes</label><input type="range" id="durSixteenth" min="0" max="100" value="10"><span id="valSixteenth">10%</span>
  <label>Dotted Sixteenth</label><input type="range" id="durDottedSixteenth" min="0" max="100" value="3"><span id="valDottedSixteenth">3%</span>
  <label>Sixteenth Triplet</label><input type="range" id="durSixteenthTriplet" min="0" max="100" value="3"><span id="valSixteenthTriplet">3%</span>
</div>


    <!-- üéõ Tempo, Dynamics, and Interval Mixer (Right Column) -->
    <div id="tempoDynamics">
      <label for="tempoSlider">‚è± Tempo (BPM)</label>
      <input type="range" id="tempoSlider" min="40" max="240" value="90"><span id="tempoValue">90</span>

      <label for="velocitySlider">üéö Dynamic Intensity</label>
      <input type="range" id="velocitySlider" min="0.3" max="1.0" value="0.7" step="0.01"><span id="velocityValue">70%</span>

      <label for="humanizeToggle">ü§ñ Humanize Swing</label>
      <input type="checkbox" id="humanizeToggle" checked><span>On</span>

      <label for="restSlider">üï≥ Rest Probability</label>
      <input type="range" id="restSlider" min="0" max="100" value="20"><span id="restValue">20%</span>

      <label for="timingSlider">üéº Timing Var (ms)</label>
      <input type="range" id="timingSlider" min="0" max="60" value="30"><span id="timingValue">30 ms</span>

      <!-- üéö Interval Mixer embedded here -->
      <div id="intervalMixer" style="margin-top:20px;">
        <label for="w0">üîÅ Same note</label><input type="range" id="w0" min="0" max="50" value="15"><span id="v0">15%</span>
        <label for="w2">2nds</label><input type="range" id="w2" min="0" max="50" value="30"><span id="v2">30%</span>
        <label for="w3">3rds</label><input type="range" id="w3" min="0" max="50" value="20"><span id="v3">20%</span>
        <label for="w5">4ths</label><input type="range" id="w5" min="0" max="50" value="10"><span id="v5">10%</span>
        <label for="w7">5ths</label><input type="range" id="w7" min="0" max="50" value="8"><span id="v7">8%</span>
        <label for="w9">6ths / Octaves</label><input type="range" id="w9" min="0" max="50" value="4"><span id="v9">4%</span>
      </div>
    </div>


  <!-- üéµ Melody / Phrase Controls (Numeric Version) -->
  <div id="melodyPanel">
    <h3>Melody / Phrase</h3>
    <div class="number-row">
      <div class="num-wrap">
        <label>Phrase Len</label>
        <input type="number" id="numPhraseLen" min="4" max="32" value="16" step="1">
      </div>
      <div class="num-wrap">
        <label>Phrase Rest %</label>
        <input type="number" id="numPhraseRest" min="0" max="100" value="20" step="5">
      </div>
      <div class="num-wrap">
        <label>Resolve %</label>
        <input type="number" id="numPhraseResolve" min="0" max="100" value="60" step="5">
      </div>
      <div class="num-wrap">
        <label>Continue %</label>
        <input type="number" id="numProbContinue" min="0" max="100" value="60" step="5">
      </div>
      <div class="num-wrap">
        <label>Reverse %</label>
        <input type="number" id="numProbReverse" min="0" max="100" value="25" step="5">
      </div>
      <div class="num-wrap">
        <label>Repeat %</label>
        <input type="number" id="numProbRepeat" min="0" max="100" value="15" step="5">
      </div>
    </div>
  </div>
 </div>


<!-- üéº Pattern Memory Controls -->
  <div id="patternControls">
    <div id="patternBank">
      <button class="patternSlot active" data-slot="A">A</button>
      <button class="patternSlot" data-slot="B">B</button>
      <button class="patternSlot" data-slot="C">C</button>
      <button class="patternSlot" data-slot="D">D</button>
    </div>
    <button id="startRecord">‚è∫ Record</button>
    <button id="stopRecord" disabled>‚èπ Stop Rec</button>
    <button id="playPattern">‚ñ∂Ô∏è Play Pattern</button>
    <button id="clearPattern">üóë Clear</button>
    <span id="patternInfo">Active Pattern: A | No events recorded.</span>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/soundfont-player@0.12.0/dist/soundfont-player.js"></script>
  <script src="soundfont_keyboardBase12.js"></script>
</body>
</html>
