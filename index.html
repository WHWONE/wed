<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>SoundFont Virtual Keyboard ‚Äì Scales, Modes & Patterns</title>
<style>
  body {
    background: radial-gradient(circle at center, #111, #000);
    color: #eaeaea;
    font-family: "Segoe UI", sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    padding-top: 40px;
  }
  h1 { font-weight: 300; margin-bottom: 10px; }

  select, button {
    margin: 6px;
    padding: 10px 16px;
    border-radius: 8px;
    border: none;
    font-size: 1rem;
  }
  select { background:#2c2c2c; color:#eaeaea; }
  button {
    background:#4caf50;
    color:white;
    cursor:pointer;
    transition:0.2s;
  }
  button:hover { background:#43a047; }

  #keyboard {
    position: relative;
    display: flex;
    justify-content: center;
    user-select: none;
  }
  .white-keys {
    display:flex;
    position:relative;
    z-index:1;
  }
  .black-keys {
    position:absolute;
    top:0;
    left:0;
    height:150px;
    z-index:2;
  }

  .white {
    width:60px;
    height:240px;
    background:white;
    border:1px solid #000;
    border-radius:0 0 4px 4px;
    box-sizing:border-box;
    cursor:pointer;
  }
  .black {
    width:36px;
    height:150px;
    background:black;
    border:1px solid #222;
    border-radius:0 0 4px 4px;
    position:absolute;
    cursor:pointer;
  }

  .white.active {
    background:#8ef;
    box-shadow:0 0 20px #00bfff;
  }
  .black.active {
    background:#00bfff;
    box-shadow:0 0 20px #00bfff;
  }

  #status {
    margin-top:16px;
    opacity:0.8;
  }

  /* Interval Mixer */
  #intervalMixer {
    margin-top:16px;
    display:grid;
    grid-template-columns:160px 200px 50px;
    row-gap:6px;
    column-gap:8px;
    align-items:center;
    font-size:0.95rem;
  }
  input[type=range] {
    width:200px;
    cursor:pointer;
  }

  /* Tempo & Dynamics */
  #tempoDynamics {
    margin-top:20px;
    display:grid;
    grid-template-columns:180px 200px 60px;
    row-gap:8px;
    column-gap:8px;
    align-items:center;
    font-size:0.95rem;
  }

  /* Pattern Controls */
  #patternControls {
    margin-top:18px;
    display:flex;
    gap:8px;
    align-items:center;
    font-size:0.95rem;
    flex-wrap: wrap;
    justify-content: center;
  }

  #patternBank {
    display:inline-flex;
    gap:6px;
    margin-right:8px;
  }

  .patternSlot {
    background:#555;
    border:none;
    color:white;
    padding:6px 10px;
    border-radius:6px;
    cursor:pointer;
    font-size:0.9rem;
  }
  .patternSlot.active {
    background:#00bfff;
    box-shadow:0 0 8px #00bfff;
  }

  #patternInfo {
    opacity:0.75;
    margin-left:4px;
  }
</style>
</head>
<body>
  <h1>üéπ SoundFont Virtual Keyboard ‚Äì Scales, Modes & Patterns</h1>

  <div>
    <label for="keySelect">Key:</label>
    <select id="keySelect">
      <option value="C">C</option><option value="C#">C‚ôØ / D‚ô≠</option>
      <option value="D">D</option><option value="D#">D‚ôØ / E‚ô≠</option>
      <option value="E">E</option><option value="F">F</option>
      <option value="F#">F‚ôØ / G‚ô≠</option><option value="G">G</option>
      <option value="G#">G‚ôØ / A‚ô≠</option><option value="A">A</option>
      <option value="A#">A‚ôØ / B‚ô≠</option><option value="B">B</option>
    </select>

    <label for="modeSelect">Mode:</label>
    <select id="modeSelect">
      <option value="ionian">Ionian (Major)</option>
      <option value="dorian">Dorian</option>
      <option value="phrygian">Phrygian</option>
      <option value="lydian">Lydian</option>
      <option value="mixolydian">Mixolydian</option>
      <option value="aeolian">Aeolian (Minor)</option>
      <option value="locrian">Locrian</option>
      <option value="pent_major">Pentatonic Major</option>
      <option value="pent_minor">Pentatonic Minor</option>
      <option value="chromatic">Chromatic (All Notes)</option>
    </select>

<!-- üéµ Note Range Controls -->
<div id="noteRangeControls" style="margin-top:10px;">
  <label for="lowNoteSelect">Low Note:</label>
  <select id="lowNoteSelect"></select>

  <label for="highNoteSelect">High Note:</label>
  <select id="highNoteSelect"></select>
</div>

    <button id="playRandom">Play One Note</button>
    <button id="playChord">Play One Chord</button>
    <button id="playChordLoop">‚ñ∂Ô∏è Chord Loop</button>
    <button id="startLoop">‚ñ∂Ô∏è Note Loop</button>
    <button id="stopLoop" disabled>‚èπ Stop</button>
  </div>

  <div id="keyboard">
    <div class="white-keys" id="whiteKeys"></div>
    <div class="black-keys" id="blackKeys"></div>
  </div>

  <p id="status">Loading SoundFont‚Ä¶</p>

  <!-- üéö Interval Mixer -->
  <div id="intervalMixer">
    <label for="w0">üîÅ Same note</label>
    <input type="range" id="w0" min="0" max="50" value="15" step="1"><span id="v0">15%</span>

    <label for="w2">2nds</label>
    <input type="range" id="w2" min="0" max="50" value="30" step="1"><span id="v2">30%</span>

    <label for="w3">3rds</label>
    <input type="range" id="w3" min="0" max="50" value="20" step="1"><span id="v3">20%</span>

    <label for="w5">4ths</label>
    <input type="range" id="w5" min="0" max="50" value="10" step="1"><span id="v5">10%</span>

    <label for="w7">5ths</label>
    <input type="range" id="w7" min="0" max="50" value="8" step="1"><span id="v7">8%</span>

    <label for="w9">6ths / Octaves</label>
    <input type="range" id="w9" min="0" max="50" value="4" step="1"><span id="v9">4%</span>
  </div>

  <!-- üéõ Tempo & Dynamics -->
  <div id="tempoDynamics">
    <label for="tempoSlider">‚è± Tempo (BPM)</label>
    <input type="range" id="tempoSlider" min="40" max="240" value="90" step="1">
    <span id="tempoValue">90</span>

    <label for="velocitySlider">üéö Dynamic Intensity</label>
    <input type="range" id="velocitySlider" min="0.3" max="1.0" value="0.7" step="0.01">
    <span id="velocityValue">70%</span>

    <label for="humanizeToggle">ü§ñ Humanize Swing</label>
    <input type="checkbox" id="humanizeToggle" checked>
    <span>On</span>
<label for="restSlider">üï≥ Rest Probability</label>
  <input type="range" id="restSlider" min="0" max="100" value="20" step="1">
  <span id="restValue">20%</span>
   <label for="timingSlider">üéº Timing Variation (ms)</label>
  <input type="range" id="timingSlider" min="0" max="60" value="30" step="1">
  <span id="timingValue">30 ms</span>
  </div>

  <!-- üéº Pattern Memory Controls + Multi-Slot -->
  <div id="patternControls">
    <div id="patternBank">
      <button class="patternSlot active" data-slot="A">A</button>
      <button class="patternSlot" data-slot="B">B</button>
      <button class="patternSlot" data-slot="C">C</button>
      <button class="patternSlot" data-slot="D">D</button>
    </div>

    <button id="startRecord">‚è∫ Record</button>
    <button id="stopRecord" disabled>‚èπ Stop Rec</button>
    <button id="playPattern">‚ñ∂Ô∏è Play Pattern</button>
    <button id="clearPattern">üóë Clear</button>

    <span id="patternInfo">Active Pattern: A | No events recorded.</span>
  </div>

  <!-- üéº Measure Composer -->
  <div id="measureComposer" style="margin-top:24px; text-align:center;">
    <h3>ü™∂ Measure Composer</h3>
    <label for="beatsPerMeasure">Beats / Measure:</label>
    <input type="number" id="beatsPerMeasure" min="1" max="12" value="4" style="width:60px;">
    
    <label for="noteDuration">Note Duration:</label>
    <select id="noteDuration">
      <option value="whole">Whole</option>
      <option value="half">Half</option>
      <option value="quarter" selected>Quarter</option>
      <option value="eighth">Eighth</option>
    </select>

    <button id="addMeasureNote">‚ûï Add Note</button>
    <button id="playMeasure">‚ñ∂Ô∏è Play Measure</button>

    <p id="measureStatus">No notes added yet.</p>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/soundfont-player@0.12.0/dist/soundfont-player.js"></script>
  <script src="soundfont_keyboardBase12.js"></script>



</body>
</html>
